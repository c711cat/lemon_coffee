(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8570dc1c"],{1315:function(e,t,n){"use strict";n("c6f4")},"159b":function(e,t,n){var o=n("da84"),c=n("fdbc"),i=n("785a"),r=n("17c2"),a=n("9112"),s=function(e){if(e&&e.forEach!==r)try{a(e,"forEach",r)}catch(t){e.forEach=r}};for(var p in c)c[p]&&s(o[p]&&o[p].prototype);s(i)},"17c2":function(e,t,n){"use strict";var o=n("b727").forEach,c=n("a640"),i=c("forEach");e.exports=i?[].forEach:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}},b738:function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),c=function(e){return Object(o["pushScopeId"])("data-v-e0f47a14"),e=e(),Object(o["popScopeId"])(),e},i={key:1,class:"wrap p-my-0 p-mx-auto p-p-2"},r=c((function(){return Object(o["createElementVNode"])("div",{class:"divider p-pl-3"},[Object(o["createElementVNode"])("h4",null,"購買清單")],-1)})),a={class:"p-col-12 p-lg-5 p-pl-3"},s=c((function(){return Object(o["createElementVNode"])("br",null,null,-1)})),p=c((function(){return Object(o["createElementVNode"])("br",null,null,-1)})),l={class:"p-col-5 p-lg-3 p-pl-3"},d={class:"p-col-3 p-lg-1 p-p-0 p-my-3"},u={class:"p-col-3 p-lg-2 p-text-right subtotal-container"},b={class:"p-grid p-mx-0 p-my-2"},g={class:"p-col-12"},m={class:"p-grid p-jc-between p-text-right p-ai-center"},h=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-7 p-lg-9 p-pr-0"},"小計",-1)})),f={class:"p-col-5 p-lg-3"},j=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-7 p-lg-9 p-pr-0"},"運費",-1)})),O={class:"p-col-5 p-lg-3"},v={key:0,class:"p-col-7 p-lg-9 p-pr-0"},E={key:1,class:"p-col-5 p-lg-3"},_=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-7 p-lg-9 p-text-bold checkout-price p-pr-0"}," 總付款金額 ",-1)})),y={class:"p-col-5 p-lg-3 p-text-bold checkout-price"},N=c((function(){return Object(o["createElementVNode"])("div",{class:"divider p-pl-3"},[Object(o["createElementVNode"])("h4",null,"收件人資料")],-1)})),V={class:"p-grid nested-grid p-m-1 p-pl-2"},k={class:"p-col-12 p-lg-7 p-mt-3"},x={class:"p-grid p-fluid p-ai-center"},w=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"姓名",-1)})),S={class:"p-col-8 p-lg-10"},T=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"電話",-1)})),D={class:"p-col-8 p-lg-10"},B=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"Email",-1)})),C={class:"p-col-8 p-lg-10"},I=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"送貨方式",-1)})),L={class:"p-col-8 p-lg-10"},$={key:0,class:"p-col-4 p-lg-2 p-text-bold"},M={key:1,class:"p-col-8 p-lg-10"},q=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"付款方式",-1)})),H={class:"p-col-8 p-lg-10"},J=c((function(){return Object(o["createElementVNode"])("div",{class:"p-col-4 p-lg-2 p-text-bold"},"備註",-1)})),z={class:"p-col-8 p-lg-10"},A={class:"p-grid p-jc-end p-ai-end p-col-12 p-pb-3 p-m-0 p-text-right p-pr-0"},F={class:"p-col-fixed",style:{width:"127px"}};function P(e,t,n,c,P,W){var G=Object(o["resolveComponent"])("Loading"),K=Object(o["resolveComponent"])("Button"),Q=Object(o["resolveComponent"])("router-link"),R=Object(o["resolveComponent"])("ProgressSpinner");return P.isLoading?(Object(o["openBlock"])(),Object(o["createBlock"])(G,{key:0})):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",i,[r,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(P.cartItems,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:"p-grid p-m-0 p-py-3 divider p-ai-center p-jc-between",key:e.product_id+e.package_type},[Object(o["createElementVNode"])("div",a,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.product_name),1),s,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(W.groundText(e.ground)),1),p]),Object(o["createElementVNode"])("div",l," $ "+Object(o["toDisplayString"])(e.unit_price)+" / "+Object(o["toDisplayString"])(W.typeText(e.package_type)),1),Object(o["createElementVNode"])("div",d,"數量 "+Object(o["toDisplayString"])(e.quantity),1),Object(o["createElementVNode"])("div",u,[Object(o["createElementVNode"])("div",null,"$ "+Object(o["toDisplayString"])(e.unit_price*e.quantity),1)])])})),128)),Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("div",g,[Object(o["createElementVNode"])("div",m,[h,Object(o["createElementVNode"])("div",f,"$ "+Object(o["toDisplayString"])(W.subtotal),1),j,Object(o["createElementVNode"])("div",O,"$ "+Object(o["toDisplayString"])(W.origin_shipping_fee),1),W.free_shipping?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",v,"滿千免運")):Object(o["createCommentVNode"])("",!0),W.free_shipping?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",E,[Object(o["createElementVNode"])("del",null,"$ "+Object(o["toDisplayString"])(W.origin_shipping_fee),1)])):Object(o["createCommentVNode"])("",!0),_,Object(o["createElementVNode"])("div",y," $ "+Object(o["toDisplayString"])(W.final_shipping_fee+W.subtotal),1)])])]),N,Object(o["createElementVNode"])("div",V,[Object(o["createElementVNode"])("div",k,[Object(o["createElementVNode"])("div",x,[w,Object(o["createElementVNode"])("div",S,Object(o["toDisplayString"])(P.shipping_info.name),1),T,Object(o["createElementVNode"])("div",D,Object(o["toDisplayString"])(P.shipping_info.phone_number),1),B,Object(o["createElementVNode"])("div",C,Object(o["toDisplayString"])(P.shipping_info.email),1),I,Object(o["createElementVNode"])("div",L,Object(o["toDisplayString"])(W.shippingMethodText),1),W.isHomeDelivery?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",$," 收件地址 ")):Object(o["createCommentVNode"])("",!0),W.isHomeDelivery?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",M,Object(o["toDisplayString"])(P.shipping_info.address),1)):Object(o["createCommentVNode"])("",!0),q,Object(o["createElementVNode"])("div",H,Object(o["toDisplayString"])(W.paymentMethodText),1),J,Object(o["createElementVNode"])("div",z,Object(o["toDisplayString"])(P.note),1)])]),Object(o["createElementVNode"])("div",A,[Object(o["createVNode"])(Q,{to:"/cart",class:"p-lg-2 link-content"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(K,{class:"p-button-lg p-button-info p-button-raised",label:"修改"})]})),_:1}),Object(o["createElementVNode"])("div",F,[Object(o["createVNode"])(K,{disabled:P.btnIsLoading,onClick:Object(o["withModifiers"])(W.createOrder,["prevent"]),class:"p-button-lg p-button-raised p-button-danger",label:"下訂單"},{default:Object(o["withCtx"])((function(){return[P.btnIsLoading?(Object(o["openBlock"])(),Object(o["createBlock"])(R,{key:0,style:{width:"63px",height:"27px"},strokeWidth:"8",animationDuration:"10s"})):Object(o["createCommentVNode"])("",!0)]})),_:1},8,["disabled","onClick"])])])])]))}var W=n("2909"),G=(n("d3b7"),n("159b"),n("bc3a")),K=n.n(G),Q=n("852e"),R=n.n(Q),U=n("3a5e"),X={data:function(){return{cartItems:[],note:"",shipping_info:{name:"",phone_number:"",address:"",email:"",shipping_method:""},isLoading:!1,btnIsLoading:!1}},components:{Loading:U["a"]},inject:["emitter"],methods:{getCart:function(){var e=this,t="".concat("https://lemon-coffee.herokuapp.com","/users/cart_items"),n={Authorization:R.a.get("lemonToken")};this.isLoading=!0,K.a.get(t,{headers:n}).then((function(t){if(200===t.status){e.cartItems=Object(W["a"])(t.data);var n=JSON.parse(localStorage.getItem("personalData"))||{};e.note=n.note,e.shipping_info=n.shipping_info}})).catch((function(t){401===t.response.status&&(R.a.remove("lemonToken"),e.showErrorToast("請重新登入"),e.$router.push("/entrance/login"))})).finally((function(){e.isLoading=!1}))},typeText:function(e){return"drip_bag"===e?"耳掛":"half_pound"===e?"半磅":"one_pound"===e?"一磅":void 0},groundText:function(e){return!0===e?"磨粉":!1===e?"原豆":void 0},createOrder:function(){var e=this,t="".concat("https://lemon-coffee.herokuapp.com","/users/orders"),n={Authorization:R.a.get("lemonToken")},o={order:{note:this.note,shipping_info:this.shipping_info}};this.btnIsLoading=!0,K.a.post(t,o,{headers:n}).then((function(t){201===t.status&&(e.showSuccessToast("已成立訂單"),e.$router.push("/order/".concat(t.data.id)),e.emitter.emit("changeCartBadgeCount",0))})).catch((function(t){401===t.response.status&&(R.a.remove("lemonToken"),e.showErrorToast("請重新登入"),e.$router.push("/entrance/login"),e.emitter.emit("changeCartBadgeCount",0)),400===t.response.status&&t.response.data.cart&&e.showErrorToast("你的購物車是空的"),400===t.response.status&&t.response.data.name&&e.showErrorToast("請填入 : 收件人姓名"),400===t.response.status&&t.response.data.phone_number&&e.showErrorToast("請填入 : 收件人電話"),400===t.response.status&&t.response.data.address&&e.showErrorToast("請填入 : 收件地址"),400===t.response.status&&t.response.data.email&&e.showErrorToast("請填入 : 收件人 email")})).finally((function(){e.btnIsLoading=!1}))},showSuccessToast:function(e){this.$toast.add({severity:"success",summary:e,life:2e3})},showErrorToast:function(e){this.$toast.add({severity:"error",summary:e,life:5e3})}},computed:{subtotal:function(){var e=0;return this.cartItems.forEach((function(t){e+=t.unit_price*t.quantity})),e},origin_shipping_fee:function(){switch(this.shipping_info.shipping_method){case"home_delivery":return 100;default:return 0}},final_shipping_fee:function(){return this.subtotal>=1e3?0:this.origin_shipping_fee},free_shipping:function(){return 0===this.final_shipping_fee},shippingMethodText:function(){var e="";return"home_delivery"===this.shipping_info.shipping_method&&(e="宅配"),e},paymentMethodText:function(){var e="";return"cash_on_delivery"===this.shipping_info.payment_method&&(e="貨到付款"),e},isHomeDelivery:function(){var e=!1;return"home_delivery"===this.shipping_info.shipping_method&&(e=!0),e}},created:function(){this.getCart()}},Y=(n("1315"),n("6b0d")),Z=n.n(Y);const ee=Z()(X,[["render",P],["__scopeId","data-v-e0f47a14"]]);t["default"]=ee},c6f4:function(e,t,n){}}]);
//# sourceMappingURL=chunk-8570dc1c.e30a352a.js.map